<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Using uv - Python Package Manager</title>
    <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/reveal.js@4.5.0/dist/reveal.css">
    <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/reveal.js@4.5.0/dist/theme/black.css">
    <link rel="stylesheet"
        href="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/11.9.0/styles/base16/one-light.min.css">
    <style>
        .reveal {
            background: #FCF6F1;
            color: #000000;
        }

        .reveal h1,
        .reveal h2 {
            text-transform: none;
            color: #1D2954;
        }

        .reveal h3 {
            text-transform: none;
            color: #84A5DF;
        }

        .reveal code {
            background: #f6f6f6;
            color: #84A5DF;
            padding: 2px 8px;
            border-radius: 4px;
        }

        .reveal pre code {
            //background: #b3b3b3;
            color: inherit;
            padding: 20px;
            max-height: 500px;
        }

        .highlight {
            color: #42affa;
        }

        .small-text {
            font-size: 0.8em;
        }

        .reveal pre code .error-line {
            background: #ffe6e6;
            color: #d32f2f;
            display: block;
            font-weight: bold;
        }
    </style>
</head>

<body>
    <div class="reveal">
        <div class="slides">

            <!-- Slide 1: Title -->
            <section>
                <h1>Using <code>uv</code></h1>
                <h3>It makes Python packaging work</h3>
                <p class="small-text">The only Python packaging system I've ever recommended</p>
                <p>&nbsp;</p>
                <p class="small-text">Andy Casey</p>
            </section>

            <!-- Slide 2: What is uv? -->
            <section>
                <h2>What is <code>uv</code>?</h2>
                <ul>
                    <li>Extremely fast package and project manager</li>
                    <li>Written in ü¶Ä Rust by Astral (creators of Ruff)</li>
                    <li>Replaces pip, pip-tools, pipx, poetry, pyenv, virtualenv, and more</li>
                    <li><strong>10-100x faster</strong> than pip for package installation</li>
                    <li>Guarantees reproducible installations</li>
                    <li>Solves the Python packaging problem üëÄ</li>
                </ul>
            </section>

            <!-- Slide 12: Isn't This Just Another Package Manager? -->
            <section>
                <h2>Great, <emph>Another</emph> Python Package Manager ü´†</h2>
            </section>

            <!-- Slide 13: Technical Innovation - Symbolic Links -->
            <section>
                <h2>Real Technical Innovation</h2>
                <h3>Smart Package Caching with Symlinks</h3>
                <ul>
                    <li><code>uv</code> maintains a <strong>global package cache</strong></li>
                    <li>Uses <strong>symbolic links</strong> to existing installations when constraints match</li>
                    <li>Creating a new venv with the same packages? Nearly instant!</li>
                    <li>Storage overhead? Essentially zero for duplicate packages</li>
                </ul>
                <p class="small-text">No more downloading and installing the same package versions</p>
            </section>

            <!-- Slide 14: Technical Innovation - Version Resolution -->
            <section>
                <h2>Real Technical Innovation</h2>
                <h3>Integer-Based Version Resolution</h3>
                <ul>
                    <li><code>uv</code> assigns <strong>integer IDs to package versions</strong></li>
                    <li>Enables ultra-fast version comparisons and constraint solving</li>
                    <li>Dependency resolution becomes a high-performance graph problem</li>
                    <li>This is why it's 10-100x faster</li>
                </ul>
                <p class="tiny-text"><span class="highlight">conda</span> might parse (m|b)illions of version string
                    comparisons during resolution</p>
            </section>

            <!-- Slide 14: Learning from History -->
            <section>
                <h2>Learning from History: The Conda Situation</h2>
                <ul>
                    <li>Conda and pip were (rightly) constrained by wanting to avoid breaking changes</li>
                    <li>Stifled innovation, in part Python is not a good tool to manage Python</li>
                    <li>Conda caused community friction with licensing concerns</li>
                    <li>Users worried about potential license infringement issues</li>
                    <li><strong>uv has a different approach...</strong></li>
                </ul>
            </section>

            <!-- Slide 15: Truly Open Source -->
            <section>
                <h2>Truly Open Source</h2>
                <ul>
                    <li><strong>MIT/Apache 2.0 licensed</strong> - no strings attached</li>
                    <li><strong>Fully open source</strong> on GitHub</li>
                    <li>Made by Astral, but <strong>community-driven</strong></li>
                    <li>No hidden costs, no license concerns</li>
                    <li>Transparent development and governance</li>
                    <li>Not reliant on using Astral servers</li>
                </ul>
                <p class="small-text">Astral could disappear today and Python packaging would still be a solved problem
                    (which I thought would never happen!)</p>
            </section>

            <!-- Slide 16: Why Use uv? -->
            <section>
                <h2>Why Use <code>uv</code>?</h2>
                <ul>
                    <li>‚ö° <strong>It's quick</strong>: 10<sup>1</sup>-10<sup>6</sup> times faster than other tools</li>
                    <li>üîí <strong>Reproducible</strong>: Lock files ensure consistency</li>
                    <li>üõ†Ô∏è <strong>All-in-one</strong>: Replaces multiple tools</li>
                    <li>üêç <strong>Python management</strong>: Install and manage Python versions</li>
                    <li>üì¶ <strong>Modern workflow</strong>: Built for common setups</li>
                    <li>ü¶Ä <strong>Rust-powered</strong>: Reliable and efficient</li>
                    <li>üöÄ <strong>Responsive team</strong>: One of many Astral tools</li>
                </ul>
            </section>

            <!-- Slide 17: Speed Comparison -->
            <section>
                <h2>Speed Comparison</h2>
                <table style="font-size: 0.8em;">
                    <thead>
                        <tr>
                            <th>Task</th>
                            <th>Traditional Tool</th>
                            <th>uv</th>
                            <th>Speedup</th>
                        </tr>
                    </thead>
                    <tbody>
                        <tr>
                            <td>Install packages</td>
                            <td>pip</td>
                            <td>uv pip install</td>
                            <td>10-100x</td>
                        </tr>
                        <tr>
                            <td></td>
                            <td>conda</td>
                            <td>uv pip install</td>
                            <td>Up to 10<sup>6</sup></td>
                        </tr>
                        <tr>
                            <td>Create venv</td>
                            <td>python -m venv</td>
                            <td>uv venv</td>
                            <td>80x</td>
                        </tr>
                        <tr>
                            <td>Resolve deps</td>
                            <td>pip-tools</td>
                            <td>uv lock</td>
                            <td>10-100x</td>
                        </tr>
                        <tr>
                            <td>Run tools</td>
                            <td>pipx</td>
                            <td>uv tool run</td>
                            <td>Faster</td>
                        </tr>
                    </tbody>
                </table>
            </section>

            <!-- Slide 3: Installation -->
            <section>
                <h2>Installation</h2>
                <p>Install <code>uv</code> with a single command:</p>
                <pre><code class="language-bash" data-trim>
# macOS/Linux
curl -LsSf https://astral.sh/uv/install.sh | sh

# Windows
powershell -c "irm https://astral.sh/uv/install.ps1 | iex"

# With pip
pip install uv

# With Homebrew
brew install uv
                </code></pre>
            </section>

            <!-- Slide 4: Creating a Virtual Environment -->
            <section>
                <h2>Creating a Virtual Environment</h2>
                <p>Create and activate a virtual environment:</p>
                <pre><code class="language-bash" data-trim>
# Create a virtual environment
uv venv

# Activate it
source .venv/bin/activate  # macOS/Linux
.venv\Scripts\activate     # Windows
                </code></pre>
                <p class="small-text"><code>uv</code> automatically detects and uses the virtual environment</p>
            </section>

            <!-- Slide 5: Installing Packages -->
            <section>
                <h2>Installing Packages</h2>
                <pre><code class="language-bash" data-trim>
# Install a package
uv pip install requests

# Install multiple packages
uv pip install requests pandas numpy

# Install from requirements.txt
uv pip install -r requirements.txt

# Install with specific version
uv pip install "django>=4.0,<5.0"
                </code></pre>
            </section>

            <!-- Slide 6: Managing Python Versions -->
            <section>
                <h2>Managing Python Versions</h2>
                <p><code>uv</code> can install and manage Python itself!</p>
                <pre><code class="language-bash" data-trim>
# List available Python versions
uv python list

# Install a specific Python version
uv python install 3.12

# Use a specific Python version
uv venv --python 3.12

# uv auto-installs missing Python versions as needed
                </code></pre>
            </section>

            <!-- Slide 7: Project Management -->
            <section>
                <h2>Project Management</h2>
                <pre><code class="language-bash" data-trim>
# Initialize a new project
uv init my-project
cd my-project

# Add a dependency (updates pyproject.toml)
uv add requests

# Remove a dependency
uv remove requests

# Sync environment with project dependencies
uv sync
                </code></pre>
            </section>

            <!-- Slide 8: Lock Files -->
            <section>
                <h2>Reproducible Builds</h2>
                <p><code>uv</code> creates lock files for precise dependency resolution</p>
                <pre><code class="language-bash" data-trim>
# Generate/update lock file
uv lock

# Install from lock file (exact versions)
uv sync

# This ensures everyone gets the same dependencies!
                </code></pre>
                <p class="small-text">Unlike pip, <code>uv</code> guarantees reproducible installations</p>
            </section>

            <!-- Slide 9: Running Scripts -->
            <section>
                <h2>Running Scripts</h2>
                <pre><code class="language-bash" data-trim>
# Run a Python script with dependencies
uv run script.py

# Run a module
uv run -m pytest

# Execute a package (like pipx)
uv tool run ruff check .

# Run inline script with dependencies
uv run --with requests python -c \
"
import requests as r
print(r.get('https://api.github.com').json())
"

                </code></pre>
            </section>

            <!-- Slide 10: Run Tools Without Installing -->
            <section>
                <h2>Run Tools Without Installing</h2>
                <p>Use <code>uvx</code> to instantly run any Python tool from PyPI:</p>
                <pre><code class="language-bash" data-trim>
            # Run a tool you've never installed
            ‚ùØ uvx pycowsay hello from uv
            Installed 1 package in 3ms

              -------------
            < hello from uv >
              -------------
               \   ^__^
                \  (oo)\_______
                   (__)\       )\/\
                       ||----w |
                       ||     ||
                                        </code></pre>
                <p class="small-text"><code>uv</code> creates a temporary venv, installs the package, and runs it
                    automatically!</p>
            </section>


            <!-- Slide 10: Run Tools Without Installing -->
            <section>
                <h2>Run Tools Without Installing</h2>
                <p>Use <code>uvx</code> to instantly run any Python tool from PyPI:</p>
                <pre><code class="language-bash" data-trim>
# Run a tool you've never installed
uvx ruff check .

# Run a specific version
uvx black@23.0.0 myfile.py

# Run with arguments
uvx httpie https://api.github.com
                </code></pre>

                <p class="small-text">Useful if you want to try something without <i>contaminating</i> one of your
                    existing environments.</p>
            </section>



            <!-- Slide 11: Single-File Scripts -->
            <section>
                <h2>Single-File Scripts</h2>
                <p>Manage dependencies in standalone scripts:</p>
                <pre><code class="language-python" data-trim>
# /// script
# requires-python = ">=3.12"
# dependencies = [
#     "requests",
#     "rich",
# ]
# ///

import requests
from rich import print

response = requests.get("https://api.github.com")
print(response.json())
                </code></pre>
                <pre><code class="language-bash" data-trim>
uv run script.py  # Auto-installs dependencies!
                </code></pre>
            </section>

            <!-- Slide 11: Other Useful Commands -->
            <section>
                <h2>Other Useful Commands</h2>
                <pre><code class="language-bash" data-trim>
# List installed packages
uv pip list

# Show package info
uv pip show requests

# Compile requirements (like pip-compile)
uv pip compile pyproject.toml -o requirements.txt

# Upgrade packages
uv pip install --upgrade requests

# See dependency tree
uv tree
                </code></pre>
            </section>



            <!-- Slide 18: How I Use uv -->
            <section>
                <h2>How I Use <code>uv</code></h2>
                <p>Real-world workflow examples</p>
            </section>

            <!-- Slide 19: On My Laptop - Science Projects -->
            <section>
                <h2>On My Laptop: Science Projects</h2>

                <pre><code class="language-bash" data-trim>
# Setup for existing project with pyproject.toml
cd my_project
uv venv

# If there is a lock file, use it.
# .. You can (and should) commit your lock files!
# Or it will create one from your pyproject.toml file.
uv sync
                </code></pre>
                <ul>
                    <li>Each project has its own virtual environment</li>
                    <li>Project-specific dependencies and versions</li>
                    <li>Reproducible environments with lock files</li>
                    <li>Easy to share and collaborate</li>
                </ul>
            </section>

            <!-- Slide 20: Auto-activation with cd -->
            <section>
                <h2>Auto-activation with <code>cd</code></h2>
                <p class="small-text">Override <code>cd</code> to automatically activate/deactivate venvs:</p>
                <pre><code class="language-bash" data-trim data-line-numbers>
function cd() {
  builtin cd "$@"

  if [[ -z "$VIRTUAL_ENV" ]] ; then
      if [[ -d ./.venv ]] ; then
        source ./.venv/bin/activate
      fi
  else
      parentdir="$(dirname "$VIRTUAL_ENV")"
      if [[ "$PWD"/ != "$parentdir"/* ]] ; then
        deactivate
      fi
  fi
}
                </code></pre>
                <p class="small-text">Add to your <code>~/.bashrc</code> or <code>~/.zshrc</code></p>
            </section>

            <!-- Slide 21: Protects Me From Silly Mistakes -->
            <section>
                <h2>Protects Me From Silly Mistakes</h2>
                <pre><code class="language-text" data-trim>
$ cd some_folder
$ uv add strict_versions_and_big_dependency_graph
error: No virtual environment found; run `uv venv` to create an environment,
       or pass `--system` to install into a non-virtual environment

$ python
zsh: command not found: python

$ which python
python not found
                </code></pre>
                <p class="small-text">I have <strong>no global python</strong> installed!</p>
                <p class="small-text">Either I'm in the wrong directory, or I haven't created an environment for this
                    project yet.</p>
            </section>

            <!-- Slide 22: On My Laptop - Scratch Environment -->
            <section>
                <h2>My Scratch Environment</h2>
                <ul>
                    <li><strong>Location</strong>: <code>~/research/</code></li>
                    <li>General-purpose stack with most tools I need</li>
                    <li>Don't care about specific versions</li>
                    <li>It's okay if it breaks - just recreate it!</li>
                    <li>Perfect for quick experiments and testing ideas</li>
                </ul>
            </section>

            <!-- Slide 21: On the Cluster -->
            <section>
                <h2>On Flatiron Clusters</h2>
                <p>Load <code>uv</code> using the module system:</p>
                <pre><code class="language-bash" data-trim>
module load uv
                </code></pre>
                <p class="small-text">As per <a
                        href="https://wiki.flatironinstitute.org/SCC/Software/UvPython#uv_on_the_cluster">the docs</a>,
                    this will set</p>
                <pre><code class="language-bash" data-trim>UV_CACHE_DIR=$HOME/.cache/uv</code></pre>
                <p class="small-text">because your virtual environments should be in <code>$HOME</code> and not ceph,
                    and <code>uv</code>'s file linking strategy only works within a filesystem.</p>
            </section>

            <!-- Slide 22: Getting Started -->
            <section>
                <h2>Quick Start Guide</h2>
                <pre><code class="language-bash" data-trim>
# 1. Install uv
curl -LsSf https://astral.sh/uv/install.sh | sh

# 2. Create a new project
uv init my-app && cd my-app

# 3. Add dependencies
uv add requests pandas

# 4. Run your code
uv run main.py

# That's it! üéâ
                </code></pre>
            </section>

            <!-- Slide 23: Resources -->
            <section>
                <h2>Resources</h2>
                <ul>
                    <li>Documentation: <a href="https://docs.astral.sh/uv/">docs.astral.sh/uv</a></li>
                    <li>GitHub: <a href="https://github.com/astral-sh/uv">github.com/astral-sh/uv</a></li>
                    <li>Website: <a href="https://astral.sh/">astral.sh</a></li>
                    <li>Blog: <a href="https://astral.sh/blog">astral.sh/blog</a></li>
                    <li>Podcast: <a
                            href="https://talkpython.fm/episodes/show/476/unified-python-packaging-with-uv">Unified
                            Python packaging with uv</a></li>
                </ul>
                <br><br>
                <h3>Thank You! üöÄ</h3>
            </section>

        </div>
    </div>

    <script src="https://cdn.jsdelivr.net/npm/reveal.js@4.5.0/dist/reveal.js"></script>
    <script src="https://cdn.jsdelivr.net/npm/reveal.js@4.5.0/plugin/highlight/highlight.js"></script>
    <script>
        Reveal.initialize({
            hash: true,
            transition: 'slide',
            plugins: [RevealHighlight]
        });

        // Color error text red after highlighting
        Reveal.on('ready', () => {
            document.querySelectorAll('code').forEach(block => {
                if (block.textContent.includes('error: No virtual environment found')) {
                    block.innerHTML = block.innerHTML.replace(
                        /(error: No virtual environment found)/g,
                        '<span style="color: #d32f2f; font-weight: bold;">error:</span> No virtual environment found'
                    );
                }
            });
        });
    </script>
</body>

</html>
